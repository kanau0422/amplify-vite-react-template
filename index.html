<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>座席予約システム</title>
  <style>
    body {
      font-family: sans-serif;
      background-color: #f5f5f5;
      margin: 0;
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
    }

    .screen {
      display: none;
      width: 400px;
      background: white;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    .screen.active {
      display: block;
    }

    input, select, button {
      width: 100%;
      padding: 12px;
      margin: 10px 0;
      font-size: 16px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }

    button {
      background-color: #007bff;
      color: white;
      border: none;
      cursor: pointer;
    }

    .seat-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-top: 20px;
    }

    .seat-grid button {
      padding: 15px;
      font-size: 16px;
      background-color: #28a745;
    }

    .confirmation {
      background-color: #e0ffe0;
      padding: 15px;
      text-align: center;
      border: 1px solid #9ccc9c;
      border-radius: 6px;
      margin-top: 15px;
    }
  </style>
</head>
<body>

  <!-- 1. ログイン画面 -->
  <div id="loginScreen" class="screen active">
    <h2>ログイン</h2>
    <input type="text" id="employeeId" autocomplete="off" placeholder="社員番号" />
    <input type="password" id="password" autocomplete="off" placeholder="パスワード" />
    <button onclick="login()">ログイン</button>
  </div>

  <!-- 2. 着席予定入力 -->
  <div id="timeInputScreen" class="screen">
    <h2>着席予定の入力</h2>
    <input type="date" id="reserveDate" />
    <select id="reserveTime">
      <option value="">時間帯を選択</option>
      <option value="morning">午前（9:00〜12:00）</option>
      <option value="afternoon">午後（13:00〜17:00）</option>
      <option value="full">終日（9:00〜17:00）</option>
    </select>
    <button onclick="showAvailableSeats()">空席を表示</button>
  </div>    

  <!-- 3. 空席表示 -->
  <div id="seatSelectionScreen" class="screen">
    <h2>空いている席を選択</h2>
    <div id="seatGrid" class="seat-grid"></div>
  </div>

  <!-- 4. 予約完了画面 -->
  <div id="confirmationScreen" class="screen">
    <h2>予約完了</h2>
    <div id="confirmationMessage" class="confirmation"></div>
    <button onclick="showScreen('loginScreen'); callAPI()">ホームに戻る</button>
  </div>

  <script>
    let selectedTime = "";
    let selectedDate = "";
    let employeeId = "";

    function showScreen(id) {
        if (id === "loginScreen") {
            document.getElementById("employeeId").value = "";
            document.getElementById("password").value = "";
        }
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
    }

    function login() {
      const id = document.getElementById("employeeId").value;
      const pw = document.getElementById("password").value;

      if (!id || !pw) {
        alert("社員番号とパスワードを入力してください。");
        return;
      }

      if (pw === "password123") {
        employeeId = id;
        showScreen("timeInputScreen");
      } else {
        alert("パスワードが違います。");
      }
    }

    function showAvailableSeats() {
      selectedDate = document.getElementById("reserveDate").value;
      selectedTime = document.getElementById("reserveTime").value;

      if (!selectedDate || !selectedTime) {
        alert("日付と時間帯を選択してください。");
        return;
      }

      const grid = document.getElementById("seatGrid");
      grid.innerHTML = "";

      // 仮：全席空いていると仮定（本番はDBやAPI連携）
      for (let i = 1; i <= 9; i++) {
        const btn = document.createElement("button");
        btn.innerText = `${i}番`;
        btn.onclick = () => reserveSeat(i);
        grid.appendChild(btn);
      }

      showScreen("seatSelectionScreen");
    }

    function reserveSeat(seatNum) {
      const timeLabel = {
        morning: "午前",
        afternoon: "午後",
        full: "終日"
      };

      const message = `${selectedDate} の ${timeLabel[selectedTime]} に\n${seatNum}番の席を予約しました。`;
      document.getElementById("confirmationMessage").innerText = message;

      showScreen("confirmationScreen");
    }

    function goToTimeInput() {
      showScreen("timeInputScreen");
    }

    async function callApi() {
      const apiUrl = 'https://t8nyw8204c.execute-api.ap-northeast-1.amazonaws.com/test'; // ← あなたのAPIエンドポイントに変更

      try {
        const response = await fetch(apiUrl, {
          method: 'POST', // POSTにする場合は 'POST'
          headers: {
            'Content-Type': 'application/json'
            // 認証が必要な場合はここに Authorization などを追加
          }
          // body: JSON.stringify({ key: "value" }) // POST の場合はこちら
        });

        const data = await response.json();
        console.log('APIレスポンス:', data);

        document.getElementById("result").innerText = JSON.stringify(data, null, 2);
      } catch (error) {
        console.error('API呼び出しエラー:', error);
        document.getElementById("result").innerText = 'エラーが発生しました';
      }
    }

     document.getElementById(id).classList.add('active');

  </script>
</body>
</html>
